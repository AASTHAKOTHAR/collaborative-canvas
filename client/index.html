<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Collaborative Canvas</title>
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body>
    <div class="app">
      <header class="topbar">
        <div class="brand">
          <div class="logo">CC</div>
          <div class="brand-text">
            <div class="title">Collaborative Canvas</div>
            <div class="subtitle">Real-time multi-user drawing</div>
          </div>
        </div>

        <div class="status">
          <div class="pill" id="connectionPill" aria-live="polite">
            <span class="dot" aria-hidden="true"></span>
            <span id="connectionText">Connectingâ€¦</span>
          </div>
        </div>
      </header>

      <main class="main">
        <aside class="sidebar">
          <section class="panel">
            <div class="panel-title">Tools</div>

            <div class="row">
              <button class="btn tool-btn" id="toolBrush" type="button">Brush</button>
              <button class="btn tool-btn" id="toolEraser" type="button">Eraser</button>
            </div>

            <div class="row">
              <label class="field">
                <span class="label">Color</span>
                <input id="colorPicker" type="color" value="#2563eb" />
              </label>
            </div>

            <div class="row">
              <label class="field">
                <span class="label">Stroke width</span>
                <input id="strokeWidth" type="range" min="1" max="60" value="6" />
              </label>
              <div class="hint"><span id="strokeWidthValue">6</span>px</div>
            </div>

            <div class="row">
              <button class="btn" id="undoBtn" type="button">Undo (global)</button>
              <button class="btn" id="redoBtn" type="button">Redo (global)</button>
            </div>

            <div class="row">
              <button class="btn ghost" id="clearLocalOverlayBtn" type="button" title="If cursors get stuck, clear them locally.">
                Clear cursor overlays
              </button>
            </div>
          </section>

          <section class="panel">
            <div class="panel-title">Online users</div>
            <ul class="users" id="usersList" aria-live="polite"></ul>
            <div class="note">
              Cursor dots are shared in real-time. Drawing is global.
            </div>
          </section>
        </aside>

        <section class="canvas-area">
          <div class="canvas-wrap" id="canvasWrap">
            
            <canvas id="canvas" width="1200" height="800"></canvas>
            <div class="cursor-layer" id="cursorLayer" aria-hidden="true"></div>
          </div>

          <div class="footer">
            <div class="footer-left">
              Hold left mouse / touch to draw. Overlaps are ordered by server-received events.
            </div>
            <div class="footer-right" id="meLabel"></div>
          </div>
        </section>
      </main>
    </div>

    <!--
      Why CDN?
      - When you deploy the frontend as static files (e.g. Vercel), there is no Express server on the same origin
        to serve /socket.io/socket.io.js.
      - Using the official Socket.IO CDN makes the client work in both setups:
        (A) single-host (server serves client) and (B) split-host (Vercel client + separate WebSocket backend).
    -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>


    
    <script>
      // IMPORTANT (deployment):
      // - Local dev (server serves client): leave as-is -> connects to same origin.
      // - Vercel frontend + separate backend: set this to your backend URL BEFORE shipping the demo.
      //   Example:
      //   window.COLLAB_CANVAS_SOCKET_URL = "https://your-backend.example.com";
      window.COLLAB_CANVAS_SOCKET_URL = window.COLLAB_CANVAS_SOCKET_URL || window.location.origin;
    </script>
    <script type="module" src="./main.js"></script>
  </body>
</html>

